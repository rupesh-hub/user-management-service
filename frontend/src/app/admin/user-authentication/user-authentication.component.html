<div class="bg-gray-50 min-h-screen">
  <div class="container mx-auto">
    <h1 class="text-2xl font-bold text-gray-800 mb-6">Authentication Management</h1>

    <!-- Tab Navigation -->
    <div class="flex flex-wrap mb-6 bg-white rounded-lg shadow overflow-hidden">
      <button
        *ngFor="let tab of ['password-policies', 'mfa', 'sso', 'social-login', 'login-attempts', 'session-management']"
        (click)="setActiveTab(tab)"
        class="px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap"
        [ngClass]="activeTab === tab ? 'bg-indigo-600 text-white' : 'text-gray-700 hover:bg-gray-100'"
      >
        {{ tab === 'mfa' ? 'Multi-Factor Auth' : (tab === 'sso' ? 'Single Sign-On' : (tab | titlecase )) }}
      </button>
    </div>

    <!-- Password Policies -->
    <div *ngIf="activeTab === 'password-policies'" class="bg-white rounded-lg shadow p-6 mb-6">
      <h2 class="text-xl font-semibold text-gray-800 mb-4">Password Policies</h2>
      <p class="text-sm text-gray-600 mb-6">Configure password requirements and security settings for all users.</p>

      <form [formGroup]="passwordPolicyForm" (ngSubmit)="savePasswordPolicy()">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label for="minLength" class="block text-sm font-medium text-gray-700 mb-1">Minimum Password Length</label>
            <input
              type="number"
              id="minLength"
              formControlName="minLength"
              min="6"
              max="128"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
            >
            <div *ngIf="passwordPolicyForm.get('minLength')?.invalid && passwordPolicyForm.get('minLength')?.touched" class="text-red-500 text-xs mt-1">
              Please enter a value between 6 and 128
            </div>
          </div>

          <div>
            <label for="preventPasswordReuse" class="block text-sm font-medium text-gray-700 mb-1">Password History (Previous Passwords)</label>
            <input
              type="number"
              id="preventPasswordReuse"
              formControlName="preventPasswordReuse"
              min="0"
              max="24"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
            >
            <div *ngIf="passwordPolicyForm.get('preventPasswordReuse')?.invalid && passwordPolicyForm.get('preventPasswordReuse')?.touched" class="text-red-500 text-xs mt-1">
              Please enter a value between 0 and 24
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label for="expirationDays" class="block text-sm font-medium text-gray-700 mb-1">Password Expiration (Days)</label>
            <input
              type="number"
              id="expirationDays"
              formControlName="expirationDays"
              min="0"
              max="365"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
            >
            <div *ngIf="passwordPolicyForm.get('expirationDays')?.invalid && passwordPolicyForm.get('expirationDays')?.touched" class="text-red-500 text-xs mt-1">
              Please enter a value between 0 and 365 (0 means never expires)
            </div>
          </div>

          <div>
            <label for="lockoutThreshold" class="block text-sm font-medium text-gray-700 mb-1">Account Lockout Threshold (Failed Attempts)</label>
            <input
              type="number"
              id="lockoutThreshold"
              formControlName="lockoutThreshold"
              min="1"
              max="10"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
            >
            <div *ngIf="passwordPolicyForm.get('lockoutThreshold')?.invalid && passwordPolicyForm.get('lockoutThreshold')?.touched" class="text-red-500 text-xs mt-1">
              Please enter a value between 1 and 10
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label for="lockoutDuration" class="block text-sm font-medium text-gray-700 mb-1">Account Lockout Duration (Minutes)</label>
            <input
              type="number"
              id="lockoutDuration"
              formControlName="lockoutDuration"
              min="1"
              max="1440"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
            >
            <div *ngIf="passwordPolicyForm.get('lockoutDuration')?.invalid && passwordPolicyForm.get('lockoutDuration')?.touched" class="text-red-500 text-xs mt-1">
              Please enter a value between 1 and 1440 (24 hours)
            </div>
          </div>
        </div>

        <div class="space-y-4 mb-6">
          <h3 class="text-md font-medium text-gray-800">Password Complexity Requirements</h3>

          <div class="flex items-center">
            <input
              type="checkbox"
              id="requireUppercase"
              formControlName="requireUppercase"
              class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
            >
            <label for="requireUppercase" class="ml-2 block text-sm text-gray-700">
              Require at least one uppercase letter
            </label>
          </div>

          <div class="flex items-center">
            <input
              type="checkbox"
              id="requireLowercase"
              formControlName="requireLowercase"
              class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
            >
            <label for="requireLowercase" class="ml-2 block text-sm text-gray-700">
              Require at least one lowercase letter
            </label>
          </div>

          <div class="flex items-center">
            <input
              type="checkbox"
              id="requireNumbers"
              formControlName="requireNumbers"
              class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
            >
            <label for="requireNumbers" class="ml-2 block text-sm text-gray-700">
              Require at least one number
            </label>
          </div>

          <div class="flex items-center">
            <input
              type="checkbox"
              id="requireSpecialChars"
              formControlName="requireSpecialChars"
              class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
            >
            <label for="requireSpecialChars" class="ml-2 block text-sm text-gray-700">
              Require at least one special character (e.g., !&#64;#$%^&*)
            </label>
          </div>
        </div>

        <div class="flex justify-end">
          <button
            type="submit"
            [disabled]="passwordPolicyForm.invalid"
            class="bg-indigo-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-indigo-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"
          >
            Save Password Policy
          </button>
        </div>
      </form>
    </div>

    <!-- Multi-Factor Authentication -->
    <div *ngIf="activeTab === 'mfa'" class="space-y-6">
      <div class="bg-white rounded-lg shadow p-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Multi-Factor Authentication</h2>
        <p class="text-sm text-gray-600 mb-6">Configure additional authentication methods to enhance security.</p>

        <div class="space-y-6 mb-6">
          <div>
            <h3 class="text-md font-medium text-gray-800 mb-2">MFA Enforcement</h3>
            <p class="text-sm text-gray-500 mb-3">Choose how multi-factor authentication is applied to users</p>

            <div class="space-y-2">
              <div class="flex items-center">
                <input
                  type="radio"
                  id="mfa-optional"
                  name="mfaEnforcement"
                  value="optional"
                  [(ngModel)]="mfaEnforcement"
                  class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300"
                >
                <label for="mfa-optional" class="ml-2 block text-sm text-gray-700">Optional (User's choice)</label>
              </div>
              <div class="flex items-center">
                <input
                  type="radio"
                  id="mfa-required"
                  name="mfaEnforcement"
                  value="required"
                  [(ngModel)]="mfaEnforcement"
                  class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300"
                >
                <label for="mfa-required" class="ml-2 block text-sm text-gray-700">Required for all users</label>
              </div>
              <div class="flex items-center">
                <input
                  type="radio"
                  id="mfa-risk-based"
                  name="mfaEnforcement"
                  value="risk-based"
                  [(ngModel)]="mfaEnforcement"
                  class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300"
                >
                <label for="mfa-risk-based" class="ml-2 block text-sm text-gray-700">Risk-based (Prompt when suspicious activity is detected)</label>
              </div>
            </div>
          </div>

          <div>
            <h3 class="text-md font-medium text-gray-800 mb-2">Remember Device</h3>
            <p class="text-sm text-gray-500 mb-3">How long to remember a device after successful MFA</p>

            <select
              [(ngModel)]="mfaRememberDevice"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
            >
              <option [value]="0">Don't remember devices</option>
              <option [value]="1">1 day</option>
              <option [value]="7">7 days</option>
              <option [value]="30">30 days</option>
              <option [value]="90">90 days</option>
            </select>
          </div>
        </div>

        <h3 class="text-md font-medium text-gray-800 mb-4">Available Authentication Methods</h3>

        <div class="space-y-4 mb-6">
          <div *ngFor="let method of mfaMethods" class="border border-gray-200 rounded-lg p-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <div class="flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600">
                  <svg *ngIf="method.icon === 'mobile'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" />
                  </svg>
                  <svg *ngIf="method.icon === 'message-circle'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                  </svg>
                  <svg *ngIf="method.icon === 'mail'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                  </svg>
                  <svg *ngIf="method.icon === 'key'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
                  </svg>
                  <svg *ngIf="method.icon === 'fingerprint'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4" />
                  </svg>
                </div>
                <div class="ml-4">
                  <h4 class="text-sm font-medium text-gray-900">{{ method.name }}</h4>
                  <p class="text-xs text-gray-500">{{ method.description }}</p>
                </div>
              </div>
              <div class="flex items-center space-x-4">
                <div *ngIf="method.isDefault" class="text-xs font-medium text-indigo-600">Default</div>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input
                    type="checkbox"
                    [checked]="method.isEnabled"
                    (change)="toggleMfaMethod(method.id)"
                    class="sr-only peer"
                  >
                  <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                </label>
              </div>
            </div>

            <div *ngIf="method.isEnabled" class="mt-4 pt-4 border-t border-gray-200">
              <div class="flex items-center justify-between">
                <div class="text-sm text-gray-500">
                  <span *ngIf="method.setupRequired">Requires user setup</span>
                  <span *ngIf="!method.setupRequired">No setup required</span>
                </div>
                <button
                  *ngIf="!method.isDefault"
                  (click)="setDefaultMfaMethod(method.id)"
                  class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                >
                  Set as Default
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="flex justify-end">
          <button
            (click)="saveMfaSettings()"
            class="bg-indigo-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-indigo-700 transition-colors"
          >
            Save MFA Settings
          </button>
        </div>
      </div>
    </div>

    <!-- Single Sign-On -->
    <div *ngIf="activeTab === 'sso'" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- SSO Providers List -->
      <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
          <h2 class="text-lg font-medium text-gray-800">SSO Providers</h2>
          <button
            (click)="createSsoProvider()"
            class="inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
            </svg>
            Add Provider
          </button>
        </div>

        <div class="divide-y divide-gray-200 max-h-[calc(100vh-250px)] overflow-y-auto">
          <div
            *ngFor="let provider of ssoProviders"
            (click)="selectSsoProvider(provider)"
            class="px-6 py-4 cursor-pointer hover:bg-gray-50 transition-colors"
            [ngClass]="{'bg-indigo-50': selectedSsoProvider?.id === provider.id}"
          >
            <div class="flex justify-between items-start">
              <div class="flex items-center">
                <div class="flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden">
                  <svg *ngIf="provider.logo === 'okta'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 0C5.389 0 0 5.389 0 12s5.389 12 12 12 12-5.389 12-12S18.611 0 12 0zm0 18c-3.314 0-6-2.686-6-6s2.686-6 6-6 6 2.686 6 6-2.686 6-6 6z" />
                  </svg>
                  <svg *ngIf="provider.logo === 'azure'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-700" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M13.05 4.24L6.56 18.05 2 18l5.09-8.76 5.96-5m.65 1.29l.63 4.13 4.67.92-10.36 4.63 7.14-9.68m.88.98l3.76 8.31A1 1 0 0122 15.46v.03l-8.4 4.75-4.96-2.01 5.94-11.72z" />
                  </svg>
                  <svg *ngIf="provider.logo === 'google'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24">
                    <path fill="#EA4335" d="M5.26620003,9.76452941 C6.19878754,6.93863203 8.85444915,4.90909091 12,4.90909091 C13.6909091,4.90909091 15.2181818,5.50909091 16.4181818,6.49090909 L19.9090909,3 C17.7818182,1.14545455 15.0545455,0 12,0 C7.27006974,0 3.1977497,2.69829785 1.23999023,6.65002441 L5.26620003,9.76452941 Z" />
                    <path fill="#34A853" d="M16.0407269,18.0125889 C14.9509167,18.7163016 13.5660892,19.0909091 12,19.0909091 C8.86648613,19.0909091 6.21911939,17.076871 5.27698177,14.2678769 L1.23746264,17.3349879 C3.19279051,21.2970142 7.26500293,24 12,24 C14.9328362,24 17.7353462,22.9573905 19.834192,20.9995801 L16.0407269,18.0125889 Z" />
                    <path fill="#4A90E2" d="M19.834192,20.9995801 C22.0291676,18.9520994 23.4545455,15.903663 23.4545455,12 C23.4545455,11.2909091 23.3454545,10.5272727 23.1818182,9.81818182 L12,9.81818182 L12,14.4545455 L18.4363636,14.4545455 C18.1187732,16.013626 17.2662994,17.2212117 16.0407269,18.0125889 L19.834192,20.9995801 Z" />
                    <path fill="#FBBC05" d="M5.27698177,14.2678769 C5.03832634,13.556323 4.90909091,12.7937589 4.90909091,12 C4.90909091,11.2182781 5.03443647,10.4668121 5.26620003,9.76452941 L1.23999023,6.65002441 C0.43658717,8.26043162 0,10.0753848 0,12 C0,13.9195484 0.444780743,15.7301709 1.23746264,17.3349879 L5.27698177,14.2678769 Z" />
                  </svg>
                </div>
                <div class="ml-3">
                  <h3 class="text-sm font-medium text-gray-900">{{ provider.name }}</h3>
                  <p class="text-xs text-gray-500 mt-1">{{ provider.usageCount }} users</p>
                </div>
              </div>
              <div class="flex items-center">
                <span [ngClass]="provider.isEnabled ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'" class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
                  {{ provider.isEnabled ? 'Enabled' : 'Disabled' }}
                </span>
                <button
                  (click)="deleteSsoProvider(provider); $event.stopPropagation()"
                  class="ml-2 text-gray-400 hover:text-red-600 focus:outline-none"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <!-- Empty state -->
          <div *ngIf="ssoProviders.length === 0" class="px-6 py-10 text-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-10 w-10 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
            </svg>
            <p class="mt-2 text-sm text-gray-500">No SSO providers configured</p>
            <button
              (click)="createSsoProvider()"
              class="mt-3 inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            >
              Add your first provider
            </button>
          </div>
        </div>
      </div>

      <!-- SSO Provider Details / Edit / Create -->
      <div class="lg:col-span-2">
        <!-- Create/Edit SSO Provider Form -->
        <div *ngIf="isEditingSso" class="bg-white rounded-lg shadow mb-6">
          <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-lg font-medium text-gray-800">{{ selectedSsoProvider ? 'Edit SSO Provider' : 'Add SSO Provider' }}</h2>
          </div>

          <div class="p-6">
            <form [formGroup]="ssoForm" (ngSubmit)="saveSsoProvider()">
              <div class="space-y-4">
                <div>
                  <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Provider Name</label>
                  <input
                    type="text"
                    id="name"
                    formControlName="name"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="e.g., Okta, Azure AD, Google"
                  >
                  <div *ngIf="ssoForm.get('name')?.invalid && ssoForm.get('name')?.touched" class="text-red-500 text-xs mt-1">
                    Provider name is required
                  </div>
                </div>

                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="isEnabled"
                    formControlName="isEnabled"
                    class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
                  >
                  <label for="isEnabled" class="ml-2 block text-sm text-gray-700">
                    Enable this SSO provider
                  </label>
                </div>

                <div>
                  <label for="entityId" class="block text-sm font-medium text-gray-700 mb-1">Entity ID / Issuer</label>
                  <input
                    type="text"
                    id="entityId"
                    formControlName="entityId"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="e.g., https://your-domain.com"
                  >
                  <div *ngIf="ssoForm.get('entityId')?.invalid && ssoForm.get('entityId')?.touched" class="text-red-500 text-xs mt-1">
                    Entity ID is required
                  </div>
                </div>

                <div>
                  <label for="acsUrl" class="block text-sm font-medium text-gray-700 mb-1">ACS URL / Callback URL</label>
                  <input
                    type="text"
                    id="acsUrl"
                    formControlName="acsUrl"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="e.g., https://your-domain.com/auth/callback"
                  >
                  <div *ngIf="ssoForm.get('acsUrl')?.invalid && ssoForm.get('acsUrl')?.touched" class="text-red-500 text-xs mt-1">
                    ACS URL is required
                  </div>
                </div>

                <div>
                  <label for="metadataUrl" class="block text-sm font-medium text-gray-700 mb-1">Metadata URL (Optional)</label>
                  <input
                    type="text"
                    id="metadataUrl"
                    formControlName="metadataUrl"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="e.g., https://idp.example.com/metadata.xml"
                  >
                </div>

                <div>
                  <label for="certificate" class="block text-sm font-medium text-gray-700 mb-1">X.509 Certificate</label>
                  <textarea
                    id="certificate"
                    formControlName="certificate"
                    rows="5"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="-----BEGIN CERTIFICATE-----..."
                  ></textarea>
                </div>
              </div>

              <div class="mt-6 flex justify-end space-x-3">
                <button
                  type="button"
                  (click)="cancelSsoEdit()"
                  class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                >
                  Cancel
                </button>
                <button
                  type="submit"
                  [disabled]="ssoForm.invalid"
                  class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-gray-400 disabled:cursor-not-allowed"
                >
                  {{ selectedSsoProvider ? 'Save Changes' : 'Add Provider' }}
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- SSO Provider Details -->
        <div *ngIf="selectedSsoProvider && !isEditingSso" class="bg-white rounded-lg shadow">
          <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
            <h2 class="text-lg font-medium text-gray-800">Provider Details</h2>
            <button
              (click)="editSsoProvider()"
              class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
              </svg>
              Edit
            </button>
          </div>

          <div class="p-6">
            <dl class="grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2">
              <div>
                <dt class="text-sm font-medium text-gray-500">Provider Name</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ selectedSsoProvider.name }}</dd>
              </div>

              <div>
                <dt class="text-sm font-medium text-gray-500">Status</dt>
                <dd class="mt-1 text-sm">
                  <span [ngClass]="selectedSsoProvider.isEnabled ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'" class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
                    {{ selectedSsoProvider.isEnabled ? 'Enabled' : 'Disabled' }}
                  </span>
                </dd>
              </div>

              <div>
                <dt class="text-sm font-medium text-gray-500">Users</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ selectedSsoProvider.usageCount }} users</dd>
              </div>

              <div>
                <dt class="text-sm font-medium text-gray-500">Last Configured</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ selectedSsoProvider.lastConfigured | date:'MMM d, y' }}</dd>
              </div>

              <div class="sm:col-span-2">
                <dt class="text-sm font-medium text-gray-500">Description</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ selectedSsoProvider.description }}</dd>
              </div>
            </dl>

            <div class="mt-6 border-t border-gray-200 pt-6">
              <h3 class="text-md font-medium text-gray-800 mb-4">Integration Information</h3>

              <div class="bg-gray-50 rounded-md p-4 mb-4">
                <div class="flex items-center justify-between mb-2">
                  <span class="text-sm font-medium text-gray-700">Service Provider Entity ID</span>
                  <button class="text-indigo-600 hover:text-indigo-800 text-sm">
                    Copy
                  </button>
                </div>
                <div class="text-sm text-gray-600 break-all">
                  https://your-app-domain.com
                </div>
              </div>

              <div class="bg-gray-50 rounded-md p-4 mb-4">
                <div class="flex items-center justify-between mb-2">
                  <span class="text-sm font-medium text-gray-700">ACS URL</span>
                  <button class="text-indigo-600 hover:text-indigo-800 text-sm">
                    Copy
                  </button>
                </div>
                <div class="text-sm text-gray-600 break-all">
                  https://your-app-domain.com/auth/sso/callback
                </div>
              </div>

              <div class="bg-gray-50 rounded-md p-4">
                <div class="flex items-center justify-between mb-2">
                  <span class="text-sm font-medium text-gray-700">Metadata URL</span>
                  <button class="text-indigo-600 hover:text-indigo-800 text-sm">
                    Copy
                  </button>
                </div>
                <div class="text-sm text-gray-600 break-all">
                  https://your-app-domain.com/auth/sso/metadata
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No Provider Selected State -->
        <div *ngIf="!selectedSsoProvider && !isEditingSso" class="bg-white rounded-lg shadow p-6 text-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
          </svg>
          <h3 class="mt-2 text-sm font-medium text-gray-900">No provider selected</h3>
          <p class="mt-1 text-sm text-gray-500">Select a provider from the list to view and edit its details.</p>
          <div class="mt-6">
            <button
              (click)="createSsoProvider()"
              class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
              </svg>
              Add New Provider
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Social Login -->
    <div *ngIf="activeTab === 'social-login'" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Social Providers List -->
      <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
          <h2 class="text-lg font-medium text-gray-800">Social Login Providers</h2>
          <button
            (click)="createSocialProvider()"
            class="inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
            </svg>
            Add Provider
          </button>
        </div>

        <div class="divide-y divide-gray-200 max-h-[calc(100vh-250px)] overflow-y-auto">
          <div
            *ngFor="let provider of socialProviders"
            (click)="selectSocialProvider(provider)"
            class="px-6 py-4 cursor-pointer hover:bg-gray-50 transition-colors"
            [ngClass]="{'bg-indigo-50': selectedSocialProvider?.id === provider.id}"
          >
            <div class="flex justify-between items-start">
              <div class="flex items-center">
                <div class="flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden">
                  <svg *ngIf="provider.logo === 'google'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24">
                    <path fill="#EA4335" d="M5.26620003,9.76452941 C6.19878754,6.93863203 8.85444915,4.90909091 12,4.90909091 C13.6909091,4.90909091 15.2181818,5.50909091 16.4181818,6.49090909 L19.9090909,3 C17.7818182,1.14545455 15.0545455,0 12,0 C7.27006974,0 3.1977497,2.69829785 1.23999023,6.65002441 L5.26620003,9.76452941 Z" />
                    <path fill="#34A853" d="M16.0407269,18.0125889 C14.9509167,18.7163016 13.5660892,19.0909091 12,19.0909091 C8.86648613,19.0909091 6.21911939,17.076871 5.27698177,14.2678769 L1.23746264,17.3349879 C3.19279051,21.2970142 7.26500293,24 12,24 C14.9328362,24 17.7353462,22.9573905 19.834192,20.9995801 L16.0407269,18.0125889 Z" />
                    <path fill="#4A90E2" d="M19.834192,20.9995801 C22.0291676,18.9520994 23.4545455,15.903663 23.4545455,12 C23.4545455,11.2909091 23.3454545,10.5272727 23.1818182,9.81818182 L12,9.81818182 L12,14.4545455 L18.4363636,14.4545455 C18.1187732,16.013626 17.2662994,17.2212117 16.0407269,18.0125889 L19.834192,20.9995801 Z" />
                    <path fill="#FBBC05" d="M5.27698177,14.2678769 C5.03832634,13.556323 4.90909091,12.7937589 4.90909091,12 C4.90909091,11.2182781 5.03443647,10.4668121 5.26620003,9.76452941 L1.23999023,6.65002441 C0.43658717,8.26043162 0,10.0753848 0,12 C0,13.9195484 0.444780743,15.7301709 1.23746264,17.3349879 L5.27698177,14.2678769 Z" />
                  </svg>
                  <svg *ngIf="provider.logo === 'facebook'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
                  </svg>
                  <svg *ngIf="provider.logo === 'apple'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12.152 6.896c-.948 0-2.415-1.078-3.96-1.04-2.04.027-3.91 1.183-4.961 3.014-2.117 3.675-.546 9.103 1.519 12.09 1.013 1.454 2.208 3.09 3.792 3.039 1.52-.065 2.09-.987 3.935-.987 1.831 0 2.35.987 3.96.948 1.637-.026 2.676-1.48 3.676-2.948 1.156-1.688 1.636-3.325 1.662-3.415-.039-.013-3.182-1.221-3.22-4.857-.026-3.04 2.48-4.494 2.597-4.559-1.429-2.09-3.623-2.324-4.39-2.376-2-.156-3.675 1.09-4.61 1.09zM15.53 3.83c.843-1.012 1.4-2.427 1.245-3.83-1.207.052-2.662.805-3.532 1.818-.78.896-1.454 2.338-1.273 3.714 1.338.104 2.715-.688 3.559-1.701" />
                  </svg>
                  <svg *ngIf="provider.logo === 'microsoft'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24">
                    <path fill="#f25022" d="M11.4 24H0V12.6h11.4V24z" />
                    <path fill="#00a4ef" d="M24 24H12.6V12.6H24V24z" />
                    <path fill="#7fba00" d="M11.4 11.4H0V0h11.4v11.4z" />
                    <path fill="#ffb900" d="M24 11.4H12.6V0H24v11.4z" />
                  </svg>
                  <svg *ngIf="provider.logo === 'github'" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
                  </svg>
                </div>
                <div class="ml-3">
                  <h3 class="text-sm font-medium text-gray-900">{{ provider.name }}</h3>
                  <p class="text-xs text-gray-500 mt-1">{{ provider.usageCount }} users</p>
                </div>
              </div>
              <div class="flex items-center">
                <span [ngClass]="provider.isEnabled ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'" class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
                  {{ provider.isEnabled ? 'Enabled' : 'Disabled' }}
                </span>
                <button
                  (click)="deleteSocialProvider(provider); $event.stopPropagation()"
                  class="ml-2 text-gray-400 hover:text-red-600 focus:outline-none"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <!-- Empty state -->
          <div *ngIf="socialProviders.length === 0" class="px-6 py-10 text-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-10 w-10 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
            </svg>
            <p class="mt-2 text-sm text-gray-500">No social login providers configured</p>
            <button
              (click)="createSocialProvider()"
              class="mt-3 inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            >
              Add your first provider
            </button>
          </div>
        </div>
      </div>

      <!-- Social Provider Details / Edit / Create -->
      <div class="lg:col-span-2">
        <!-- Create/Edit Social Provider Form -->
        <div *ngIf="isEditingSocial" class="bg-white rounded-lg shadow mb-6">
          <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-lg font-medium text-gray-800">{{ selectedSocialProvider ? 'Edit Social Login Provider' : 'Add Social Login Provider' }}</h2>
          </div>

          <div class="p-6">
            <form [formGroup]="socialForm" (ngSubmit)="saveSocialProvider()">
              <div class="space-y-4">
                <div>
                  <label for="socialName" class="block text-sm font-medium text-gray-700 mb-1">Provider Name</label>
                  <select
                    id="socialName"
                    formControlName="name"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                  >
                    <option value="">Select a provider</option>
                    <option value="Google">Google</option>
                    <option value="Facebook">Facebook</option>
                    <option value="Apple">Apple</option>
                    <option value="Microsoft">Microsoft</option>
                    <option value="GitHub">GitHub</option>
                    <option value="Twitter">Twitter</option>
                    <option value="LinkedIn">LinkedIn</option>
                  </select>
                  <div *ngIf="socialForm.get('name')?.invalid && socialForm.get('name')?.touched" class="text-red-500 text-xs mt-1">
                    Provider name is required
                  </div>
                </div>

                <div class="flex items-center">
                  <input
                    type="checkbox"
                    id="socialIsEnabled"
                    formControlName="isEnabled"
                    class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
                  >
                  <label for="socialIsEnabled" class="ml-2 block text-sm text-gray-700">
                    Enable this social login provider
                  </label>
                </div>

                <div>
                  <label for="clientId" class="block text-sm font-medium text-gray-700 mb-1">Client ID / App ID</label>
                  <input
                    type="text"
                    id="clientId"
                    formControlName="clientId"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="e.g., your-client-id"
                  >
                  <div *ngIf="socialForm.get('clientId')?.invalid && socialForm.get('clientId')?.touched" class="text-red-500 text-xs mt-1">
                    Client ID is required
                  </div>
                </div>

                <div>
                  <label for="clientSecret" class="block text-sm font-medium text-gray-700 mb-1">Client Secret / App Secret</label>
                  <input
                    type="password"
                    id="clientSecret"
                    formControlName="clientSecret"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="e.g., your-client-secret"
                  >
                  <div *ngIf="socialForm.get('clientSecret')?.invalid && socialForm.get('clientSecret')?.touched" class="text-red-500 text-xs mt-1">
                    Client Secret is required
                  </div>
                </div>

                <div>
                  <label for="redirectUri" class="block text-sm font-medium text-gray-700 mb-1">Redirect URI / Callback URL</label>
                  <input
                    type="text"
                    id="redirectUri"
                    formControlName="redirectUri"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="e.g., https://your-domain.com/auth/callback"
                  >
                  <div *ngIf="socialForm.get('redirectUri')?.invalid && socialForm.get('redirectUri')?.touched" class="text-red-500 text-xs mt-1">
                    Redirect URI is required
                  </div>
                </div>

                <div>
                  <label for="scope" class="block text-sm font-medium text-gray-700 mb-1">Scope (Optional)</label>
                  <input
                    type="text"
                    id="scope"
                    formControlName="scope"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="e.g., email profile"
                  >
                </div>
              </div>

              <div class="mt-6 flex justify-end space-x-3">
                <button
                  type="button"
                  (click)="cancelSocialEdit()"
                  class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                >
                  Cancel
                </button>
                <button
                  type="submit"
                  [disabled]="socialForm.invalid"
                  class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-gray-400 disabled:cursor-not-allowed"
                >
                  {{ selectedSocialProvider ? 'Save Changes' : 'Add Provider' }}
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Social Provider Details -->
        <div *ngIf="selectedSocialProvider && !isEditingSocial" class="bg-white rounded-lg shadow">
          <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
            <h2 class="text-lg font-medium text-gray-800">Provider Details</h2>
            <button
              (click)="editSocialProvider()"
              class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
              </svg>
              Edit
            </button>
          </div>

          <div class="p-6">
            <dl class="grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2">
              <div>
                <dt class="text-sm font-medium text-gray-500">Provider Name</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ selectedSocialProvider.name }}</dd>
              </div>

              <div>
                <dt class="text-sm font-medium text-gray-500">Status</dt>
                <dd class="mt-1 text-sm">
                  <span [ngClass]="selectedSocialProvider.isEnabled ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'" class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
                    {{ selectedSocialProvider.isEnabled ? 'Enabled' : 'Disabled' }}
                  </span>
                </dd>
              </div>

              <div>
                <dt class="text-sm font-medium text-gray-500">Users</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ selectedSocialProvider.usageCount }} users</dd>
              </div>

              <div class="sm:col-span-2">
                <dt class="text-sm font-medium text-gray-500">Client ID</dt>
                <dd class="mt-1 text-sm text-gray-900 flex items-center">
                  <span class="flex-grow">{{ selectedSocialProvider.clientId || 'Not configured' }}</span>
                  <button *ngIf="selectedSocialProvider.clientId" class="text-indigo-600 hover:text-indigo-800 text-sm">
                    Copy
                  </button>
                </dd>
              </div>

              <div class="sm:col-span-2">
                <dt class="text-sm font-medium text-gray-500">Client Secret</dt>
                <dd class="mt-1 text-sm text-gray-900 flex items-center">
                  <span class="flex-grow">••••••••••••••••</span>
                  <button *ngIf="selectedSocialProvider.clientSecret" class="text-indigo-600 hover:text-indigo-800 text-sm">
                    Copy
                  </button>
                </dd>
              </div>
            </dl>

            <div class="mt-6 border-t border-gray-200 pt-6">
              <h3 class="text-md font-medium text-gray-800 mb-4">Integration Information</h3>

              <div class="bg-gray-50 rounded-md p-4 mb-4">
                <div class="flex items-center justify-between mb-2">
                  <span class="text-sm font-medium text-gray-700">Redirect URI</span>
                  <button class="text-indigo-600 hover:text-indigo-800 text-sm">
                    Copy
                  </button>
                </div>
                <div class="text-sm text-gray-600 break-all">
                  https://your-app-domain.com/auth/{{ selectedSocialProvider.name.toLowerCase() }}/callback
                </div>
              </div>

              <div class="bg-gray-50 rounded-md p-4">
                <h4 class="text-sm font-medium text-gray-700 mb-2">Setup Instructions</h4>
                <ol class="list-decimal list-inside text-sm text-gray-600 space-y-2">
                  <li>Go to the {{ selectedSocialProvider.name }} developer console</li>
                  <li>Create a new application or project</li>
                  <li>Configure the OAuth consent screen</li>
                  <li>Add the redirect URI shown above</li>
                  <li>Copy the Client ID and Client Secret to this page</li>
                </ol>
              </div>
            </div>
          </div>
        </div>

        <!-- No Provider Selected State -->
        <div *ngIf="!selectedSocialProvider && !isEditingSocial" class="bg-white rounded-lg shadow p-6 text-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
          </svg>
          <h3 class="mt-2 text-sm font-medium text-gray-900">No provider selected</h3>
          <p class="mt-1 text-sm text-gray-500">Select a provider from the list to view and edit its details.</p>
          <div class="mt-6">
            <button
              (click)="createSocialProvider()"
              class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
              </svg>
              Add New Provider
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Login Attempts -->
    <div *ngIf="activeTab === 'login-attempts'" class="bg-white rounded-lg shadow overflow-hidden">
      <div class="px-6 py-4 border-b border-gray-200">
        <h2 class="text-lg font-medium text-gray-800">Login Attempts</h2>
        <p class="text-sm text-gray-500 mt-1">View and monitor login activity across your application.</p>
      </div>

      <div class="p-6 border-b border-gray-200">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
          <div class="flex-grow">
            <label for="loginAttemptsSearch" class="sr-only">Search login attempts</label>
            <div class="relative rounded-md shadow-sm">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
              </div>
              <input
                type="text"
                id="loginAttemptsSearch"
                [(ngModel)]="loginAttemptsSearchTerm"
                (input)="applyLoginAttemptsFilters()"
                class="focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md"
                placeholder="Search by user, email, IP address, or location"
              >
            </div>
          </div>

          <div class="flex flex-wrap gap-2">
            <select
              [(ngModel)]="loginAttemptsDateFilter"
              (change)="applyLoginAttemptsFilters()"
              class="block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
            >
              <option value="all">All Time</option>
              <option value="today">Today</option>
              <option value="week">Last 7 Days</option>
              <option value="month">Last 30 Days</option>
            </select>

            <select
              [(ngModel)]="loginAttemptsStatusFilter"
              (change)="applyLoginAttemptsFilters()"
              class="block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
            >
              <option value="all">All Status</option>
              <option value="success">Successful</option>
              <option value="failed">Failed</option>
            </select>
          </div>
        </div>
      </div>

      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
          <tr>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              User
            </th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Time
            </th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              IP Address
            </th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Location
            </th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Device / Browser
            </th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Status
            </th>
          </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let attempt of filteredLoginAttempts">
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm font-medium text-gray-900">{{ attempt.userName }}</div>
              <div class="text-sm text-gray-500">{{ attempt.userEmail }}</div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-900">{{ attempt.timestamp | date:'MMM d, y' }}</div>
              <div class="text-sm text-gray-500">{{ attempt.timestamp | date:'h:mm a' }}</div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
              {{ attempt.ipAddress }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
              {{ attempt.location }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
              {{ attempt.device }} / {{ attempt.browser }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
                <span [ngClass]="['px-2 inline-flex text-xs leading-5 font-semibold rounded-full', getStatusClass(attempt.status)]">
                  {{ attempt.status | titlecase }}
                </span>
              <div *ngIf="attempt.failureReason" class="text-xs text-gray-500 mt-1">
                {{ attempt.failureReason }}
              </div>
            </td>
          </tr>

          <!-- Empty state -->
          <tr *ngIf="filteredLoginAttempts.length === 0">
            <td colspan="6" class="px-6 py-10 text-center text-sm text-gray-500">
              <div class="flex flex-col items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-400 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                </svg>
                <p>No login attempts found</p>
                <p class="mt-1">Try adjusting your filters or search criteria</p>
              </div>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Session Management -->
    <div *ngIf="activeTab === 'session-management'" class="space-y-6">
      <!-- Session Settings -->
      <div class="bg-white rounded-lg shadow p-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Session Settings</h2>
        <p class="text-sm text-gray-600 mb-6">Configure how user sessions are managed across your application.</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label for="sessionTimeout" class="block text-sm font-medium text-gray-700 mb-1">Session Timeout (Minutes)</label>
            <input
              type="number"
              id="sessionTimeout"
              [(ngModel)]="sessionTimeout"
              min="5"
              max="1440"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
            >
            <p class="text-xs text-gray-500 mt-1">How long until an inactive session expires (5-1440 minutes)</p>
          </div>

          <div>
            <label for="rememberMeDuration" class="block text-sm font-medium text-gray-700 mb-1">Remember Me Duration (Days)</label>
            <input
              type="number"
              id="rememberMeDuration"
              [(ngModel)]="rememberMeDuration"
              min="1"
              max="365"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
            >
            <p class="text-xs text-gray-500 mt-1">How long to keep users logged in with "Remember Me" (1-365 days)</p>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label for="maxConcurrentSessions" class="block text-sm font-medium text-gray-700 mb-1">Maximum Concurrent Sessions</label>
            <input
              type="number"
              id="maxConcurrentSessions"
              [(ngModel)]="maxConcurrentSessions"
              min="1"
              max="100"
              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
            >
            <p class="text-xs text-gray-500 mt-1">Maximum number of active sessions per user (1-100)</p>
          </div>

          <div class="flex items-center">
            <input
              type="checkbox"
              id="enforceOneSession"
              [(ngModel)]="enforceOneSession"
              class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
            >
            <label for="enforceOneSession" class="ml-2 block text-sm text-gray-700">
              Enforce single session per user (log out other sessions when a user logs in)
            </label>
          </div>
        </div>

        <div class="flex justify-end">
          <button
            (click)="saveSessionSettings()"
            class="bg-indigo-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-indigo-700 transition-colors"
          >
            Save Session Settings
          </button>
        </div>
      </div>

      <!-- Active Sessions -->
      <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
          <h2 class="text-lg font-medium text-gray-800">Active Sessions</h2>
          <button
            (click)="terminateAllSessions()"
            class="inline-flex items-center px-3 py-1.5 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            Terminate All Other Sessions
          </button>
        </div>

        <div class="p-6 border-b border-gray-200">
          <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
            <div class="flex-grow">
              <label for="sessionSearch" class="sr-only">Search sessions</label>
              <div class="relative rounded-md shadow-sm">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                  </svg>
                </div>
                <input
                  type="text"
                  id="sessionSearch"
                  [(ngModel)]="sessionSearchTerm"
                  (input)="applySessionFilters()"
                  class="focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md"
                  placeholder="Search by user, device, browser, or location"
                >
              </div>
            </div>
          </div>
        </div>

        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
            <tr>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                User
              </th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                Device / Browser
              </th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                Location
              </th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                Started
              </th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                Last Activity
              </th>
              <th scope="col" class="relative px-6 py-3">
                <span class="sr-only">Actions</span>
              </th>
            </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
            <tr *ngFor="let session of filteredSessions" [ngClass]="{'bg-green-50': session.isCurrent}">
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <div>
                    <div class="text-sm font-medium text-gray-900">{{ session.userName }}</div>
                    <div class="text-sm text-gray-500">{{ session.userEmail }}</div>
                  </div>
                  <div *ngIf="session.isCurrent" class="ml-2">
                      <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                        Current
                      </span>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-gray-900">{{ session.device }}</div>
                <div class="text-sm text-gray-500">{{ session.browser }}</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-gray-900">{{ session.location }}</div>
                <div class="text-sm text-gray-500">{{ session.ipAddress }}</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-gray-900">{{ session.startTime | date:'MMM d, y' }}</div>
                <div class="text-sm text-gray-500">{{ session.startTime | date:'h:mm a' }}</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-gray-900">{{ formatTimeAgo(session.lastActivity) }}</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                <button
                  *ngIf="!session.isCurrent"
                  (click)="terminateSession(session.id)"
                  class="text-red-600 hover:text-red-900"
                >
                  Terminate
                </button>
              </td>
            </tr>

            <!-- Empty state -->
            <tr *ngIf="filteredSessions.length === 0">
              <td colspan="6" class="px-6 py-10 text-center text-sm text-gray-500">
                <div class="flex flex-col items-center">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-400 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                  </svg>
                  <p>No active sessions found</p>
                  <p class="mt-1">Try adjusting your search criteria</p>
                </div>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

